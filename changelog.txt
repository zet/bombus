09.03.2005
 MessageList теперь показывает символ ">" в конце строки, обозначая
 неполное отображение сообщения в списке. требуется просмотреть сообщение

 presence type error теперь отображается дополнительным значком.

 кэширование строк ростера. очень актуально для M55

 заменён разделитель смайликов с 0x20 на 0x09 для смайликов, содержащих " "

 сравнение jid теперь non-case-sensitive

 сплэш для m55

10.03.2005
 научился компилировать под платформу M55

 проба со звуком и виброй

 "Failed", если неверный логин

11.03.2005
 иконка subscription=none

 в версии M55 поменялись местами вызовы Player и Vibra

 теперь инициализация соединения производится не в Roster(),
 а в Roster.run() - закладка возможности Reconnect

 Reconnect, Logoff

 - пока нет проверок при отправках сообщений на offline

12.03.2005
 кэш ростера включен

 переделан MessageList - теперь каждое сообщение в отдельной строке


14.03.2005
 найдена уязвимость к DoS атаке - приём большого пакета данных.

16.03.2005
 багфикс VirtualList.moveCursorTo(index) - курсор попадал на неполностью 
 прорисованную строку внизу рабочей области - не учитывалась высота заголовка

 осознана необходимость оформить Vector "строки и иконки вперемежку" в отдельный
 класс.

 сделан пакующий скрипт для релиза версий.

 пробные фиксы для ширины парсинга (частично решает проблему символа '>' )

 команда Back в MessageView

17.03.2005
 создан класс ComplexString - содержит: 
  подстроки, 
  индексы иконок, 
  прикреплённый ImageList
  цвет следующей подстроки

 переведены на этот класс заголовки окон, строки MessageView и MessageList

 VirtualList теперь использует строки переменной высоты.
 теоретически возможно некоторое замедление из-за необходимости пересчёта числа
 отображаемых строк при перемещении вверх.

 отключен cursorOutline для m55

18.03.2005
 багфиксы перемещения курсора, вызванные изменениями VirtualList

 выход из SmilePicker

 скроллбар динамический - появляется только при необходимости
 пока не изменяется ширина отрисовываемого LostItem, но курсор рисуется
 на всю доступную ширину


 парсинг сообщения в MessageView вынесен из конструктора в Thread, что позволяет
 читать сообщение ещё в процессе парсинга.

19.03.2005
 очередные багфиксы перемещения курсора, вызванные изменениями VirtualList
 (pageup)

 Home/End в SmilePicker теперь перемещают на 1 и последний смайл соответственно,
 а не на 1-ю и последнюю строку смайлов

 увеличен период вызовов repaint при парсинге (1 вызов на 5 строк)

 параметр KeepAlive в jad - период посылки пакета для поддержки соединения
 (по умолчанию 300 секунд). посылается символ ' '

 класс Config с глобальным доступом (singleton) - чтение настроек из jad и rms

 в MessageList добавлена команда Quote

 в заголовке MessageEdit пишется "Кому"

 не сбрасываются при переходе в offline статусы error и subscription:none

 выравнивание элемента ComplexString по правой границе

 фикс - переход в offline в случае потери соединения не приводил к обновлению
 экрана


21.03.2005
 окно выбора аккаунта AccountSelect (пока нет защиты от пустых аккаунтов)
 пока не показывает активный аккаунт

 хранение аккаунтов в rms

 форма создания и редактирования аккаунта

 первый раз после установки в телефон приложение всегда выдаёт AccountSelect
 при повторных запусках - по нажатию клавиши в процессе надписи Loading.
 пока нет мнговенной реакции на нажатие клавиши, т.к. происходит загрузка классов

 изменение имён атрибутов аккаунта по умолчанию (jad)

 пробы context-sensitive меню.

22.03.2005
 правка выравнивания по правому краю.

 правка Account.createFromJad - теперь всегда возвращает null при неудачном
 считывании (если нет def_user, def_pass, ...)

 правка Account.createFromRMS - теперь всегда возвращает null при неудачном
 считывании

 выделение активного аккаунта в AccountSelect

23.03.2005
 для M55 конфигурация и аккаунты теперь хранятся в файлах, а не в rms
 (папка storage)

25.03.2005
 Путь конфигурации в jad вида: cfg_path: a:\путь\
 закрывающий слэш обязателен!
 по умолчанию - папка storage

 проба подключения значка "вибры" - пока без функциональности

 теперь VirtualList заполняет экран чистым фоном, если нет ни одного элемента
 немного оптимизирована отрисовка фона

 инфа о версии берётся из jad

26.03.2005
 в MessageList добавляются статусы контакта.
 
 сделано редактирование статусов. возможна установка приоритета и сообщения 
 для каждого статуса.

 хранение статусов в store/file "status"

 очень вырос размер (на 4.5 кб) :'(

 уменьшена задержка появления картинки сплэш-скрина.

 в сплэшскрине теперь ip сервера не отображается, пишется только имя сервера

27.03.2005

 атрибут в jad alert_profile: 0..4
    AUTO=0; (пока =1)
    ALL=1; (default)
    NONE=2;
    VIBRA=3;
    SOUND=4;
 обозначает профиль по умолчанию. введён для отладки.

 в MessageList курсор устанавливается на первое непросмотренное сообщение, а
 не на статус.

 меню AlertProfile

 атрибут в jad
 msg_snd: /sounds/message.wav

28.03.2005
 Если статусное сообщение пустое, "" больше не пишутся (StatusSelect)

 исправлен поиск контакта с сообщениями, если курсор стоит на группе ("0")

 изменён цвет статусных сообщений в MessageList

 начата глобальная ревизия кода, поиск неэффективных участков

29.03.2005

 0.1.4

 скрытие оффлайн-контактов. пункт меню Show/Hide Offlines
 прячутся оффлайны без новых сообщений (может сделать только оффлайны без
 сообщений?) всё ещё нет сортировки ростера.

 имя группы теперь как в psi:    group (onlines/total)

 некоторые изменения сплэш-скрина

 сделал что-то ещё, но не помню :(

 внимание! во всех версиях MIDP2 (и в этой) в качестве звука используется
 AMR (по умолчанию). переключение - добавить атрибут в jad
 msg_snd: /sounds/message.wav

31.03.2005

 сортировка ростера - контакты в пределах группы сортируются по статусу

01.04.2005

 управление подсветкой экрана siemens m55

 m55 leds: введён атрибут led_pattern: 0..13

   0=off (default)	
   1=SPEED		
   2=LIGHTHOUSE 
   3=WAVE		
   4=BEAT	
   5=RUNWAY	
   6=TRANCE	
   7=ETERNITY	
   8=STROBO	
   9=LIMELIGHT	
   10=NORMAL_BLINKING	
   11=PULSATING	
   12=CONSTANLY_LITEUP	
   13=IDLE	

 в дальнейнем будут строковые иденты

 малые багфиксы. (поведение Hide Contacts при Logoff)

09.04.2005

 0.1.5

 защита от переполнения буфера при приёме сообщения. 
 (пока жёсткое ограничение 5000 символов)
 в конце принятого обрезаного блока символы "..."

 фикс пропадания курсора при реконнекте


 запись журнала сообщений в файл вида "Log_nickname"
 msg_log: 1/0 - разрешение журнала. default=0

 msg_log_path: a:\путь\
 закрывающий слэш обязателен!
 по умолчанию - папка storage

 msg_log_presence: 1/0 - добавлять и presence 
 (шпиёнская функция. работает только при msg_log: 1)

11.04.2005
 у групп General и Transports убраны хвостовые пробелы

 исходящее сообщение: пустое сообщение не отправляется
 исходящее сообщение: тоже добавляется в журнал сообщений (фикс)

 
14.04.2005
 история Sienens: буквы Ё,ё
 история Sienens: расширение .txt
 история Sienens: DD.MM.YY hh:mm

 атрибут moto_e398: 1/0 (default=0) - пока только запрещает мигание подсветкой

 введён тип атрибутов boolean для jad.
 (moto_e398, msg_log, msg_log_presence)
 значение "истина" - true, yes или 1

 оптимизация работы редактора аккаунтов при старте - теперь не грузит намертво 
 java-машину. очень мешало пользователям S65

 команда Account - пробное переключение аккаунтов

21.04.2005
 переход на страницу cp1251 
 фикс надписи Loading (после Connect to)

24.04.2005
 0.1.6
 формат версии: A.B.C.$WCREV$

 локальный репозиторий subversion

 запись Config при выходе из программы

 изменение идеологии вызова AccountSelect; как результат - при отмене выбора аккаунта
 не происходит реконнект.

 создание аккаунта: теперь можно в поле username писать username@jabber.server
 при этом jabber.server скопируется в поле server.

 Register Account в форме нового аккаунта

 работает регистрация аккаунтов. (правда, бесполезна без добавления контактов)

 фикс: при открытии потока в заголовке
 <?xml version="1.0"?>
 <stream:stream ... to="servername" >
 вместо servername указывался ip (если был указан).

 фикс: отключен приём пустых входящих сообщений.

 15 % от управления контактами - принимаются входящие события по управлению ростером. 
 теперь контакт перемещается из группы в группу, а также удаляется по командам сервера

 фикс: считались одинаковыми jid@server/resource, jid@server/ReSoURCE, jid@server/resource2
 т.е. игнорировался регистр ресурса и (в некоторых случаях) длина.
 теперь сравниваются по следующим правилам:
 jid@server - non-case-sensitive,
 resource - case-sensitive.

 известный баг: перемещение контакта переводит его в offline.
 будет исправлено после добавления механизма subscription.

29.04.2005
 0.1.7
 сохранение профиля сигналов. 
 убран отладочный атрибут alert_profile (27.03.2005)

 в версии MIDP2 введён экспериментальный режим fullscreen

01.05.2005

 перевод VirtualList на использование VirtualElement
 пока отключен кэш строк ростера. (изменение механизма кэширования)

 убираются whitespaces в конце входящего сообщения.

 в MessageView в меню добавлен пункт Toggle Smiles. горячая клавиша - *

 ростер:
 добавлено меню "Contact >" - операции с выбраным контактом
 добавлена команда Add Contact
 команды пока нефункциональны.	

Motorola:
 Background: True
 FlipInsensitive: True
 позволяют приложению работать в фоновом режиме.

 теперь для моторолы собирается отдельный jad

02.05.2005

 курсор старается сохранить фокус при изменениях ростера.
  конечно же, сохранить позицию возможно не всегда 
  - например, потеряется, если объект исчез из отображаемого ростера 
  при hide offlines

 временно заблокирована проверка путей для теста на c55

0.1.8

 сохраняется профиль сигналов, выбраный командой Alert Profile/Set Default
 как профиль "по умолчанию" - метка (default)

 форма Options
 
 сохранение флагов Options:smiles, :transports
 скрытие группы транспортов

 Options:smiles влияет и на MessageList

 фикс Quote

 пробел перед названием команды в Contact >

 изменение порядка иконок профиля (отразилось только в структуре кода)

 расширена информация о клиенте в jabber:iq:version

03.05.2005

(28)

 fix Options:smiles

 группа Self-Contact, содержит контакты вида myjid/resource
 всегда есть контакт myjid/Bombus
 видна в случае Options:self-contact=true, либо число online-контактов
 больше 1

 заготовка в Options для not-in-list

(29)

 fix ComplexString без приаттаченного ImageList не позволял использовать 
 команды раскраски

 Options:fullscreen - убран из версии m55;

 fix Self-Contact - теперь продолжает корректно отображать статус после reconnect 

05.05.2005

 0.1.9 (34)

 fix: (частичный) конфликт между перемещением курсора кнопками и 
 сохранением фокуса на контакте при изменении порядка контактов в ростере

 Contact:Info - запрашивает vCard и версию клиента
 полученая информация сохраняется в списке сообщений.

 Add Contact - упрощённая версия - не использует ни name, ни group
 посылает запрос авторизации subscribe.

 иконка - символ состояния ask="subscribe"

 (36)
 Contact:Auth Send
 Contact:Auth Request
 Contact:Auth Remove

 известные баги: при Contact:Auth Remove в ростере добавляется jid без ресурса
 (контакт, у которого отменена авторизация)

 оптимизация обработки исключений theStream.send(JabberDataBlock)

 запросы авторизации сохраняются в виде сообщений. пока не выдаётся event

 значок реконнекта - теперь обозначает отправленый на сервер запрос.

 оптимизации кода

(37)
 удаление пока реализовано частично - удаляется только уже удалённый контакт (корзина)
 особенности авторизации - у авторизующего должен быть самый высокий приоритет

 0.1.10 (38) 
 fix: авторизация теперь использует jid без ресурсов
 авторизация работает правильно.
 TODO: 
   1. presence type=subscr* не должны влиять на статус (иногда контакт становится offline)
   2. events для presence type=subscr*, значок запроса авторизации
   3. редактирование контакта - нужна форма и выбор группы
   4. удаление контакта - мешает отсутствие диалога yes/no

 0.1.10 (39) tag

06.05.2005

(41)
  ошибки из версии 38
  fix: отделил "мух от котлет" vcard и contact info используют ресурс, 
  авторизации - нет
  fix: статусные иконки

  изменение идеологии нумерации иконок. вместо линейного индекса - двумерный
  вида 0xYX
